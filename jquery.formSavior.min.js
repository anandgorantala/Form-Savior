(function(b,k,l){b.fn.formSavior=function(f){return this.each(function(){function g(){var a=c.serialize();c.find("input[type=file]").each(function(){a+=b(this).val()});return a}var a={msg:"There are unsaved changes on this form",noprompt:"fs_noprompt"};f&&b.extend(a,f);var h="",d=!0,c=b(this),e=b(k),j=b(l);j.on("click","."+a.noprompt,function(){b(this).closest("form").addClass(a.noprompt)});e.bind("fs_beforeUnloadTriggered",function(){d=!0});j.ready(function(){h=g()});c.submit(function(){d=!1});e.bind("beforeunload",function(){if(g()!==h&&!0===d&&!c.hasClass(a.noprompt))return e.trigger("fs_beforeUnloadTriggered"),a.msg})})}})(jQuery,window,document);
